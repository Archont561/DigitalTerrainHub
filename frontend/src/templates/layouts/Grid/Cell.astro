---
import type { ComponentProps } from "astro/types";
import type { GridCellProps } from "./types";
import { createStylesheetHTML } from "./utils";
import { clsx as cn } from "clsx";
import Layout from "@layouts";

export type Props = GridCellProps & Astro.ComponentProps & ComponentProps<typeof Layout.Melt>;

const { placement, colStart, colSpan, colEnd, rowStart, rowSpan, rowEnd, ...props } = Astro.props;
const gridCellUUID = crypto.randomUUID();

Object.assign(props, {
  [gridCellUUID]: '',
  class: cn(
    "astro-grid-cell",
    props?.class
  ),
});
---

<Layout.Melt {...props}>
    <slot />
    <Fragment set:html={createStylesheetHTML({
      colStart, colSpan, colEnd, rowStart, rowSpan, rowEnd, placement
    }, gridCellUUID, "cell")} />
</Layout.Melt>