---
import { Icon } from "astro-icon/components";
import Layouts from "@layouts";
import { Utils } from "@components";

const urls = {
    home: "/",
    logout: "/credentials/logout",
    register: "/credentials/register",
    help: "/help",
    passwordReset: "/credentials/password-reset",
};
---

<Layouts.Base title="Profile">
    <div x-data="{ currentMainTab: 'Home', isCurrentTab(el, tab) { return tab === el.dataset.tab; } }" 
        class="bg-base-100 text-base-content min-h-screen flex">

        <aside class="w-64 flex flex-col p-6 border-none">
            <div class="flex items-center justify-start gap-3 mb-6 ">
                <div class="btn btn-circle btn-ghost">
                    <Icon name="heroicons:bars-4"/>
                </div>
                <img class="w-20 h-10" src="https://picsum.photos/100/200" alt="Logo" />
                <h1 class="text-xl font-bold">DTH</h1>
            </div>
            <div class="flex items-center justify-start gap-3 mb-6 -mx-2 p-2 border-1 rounded-box">
                <div class="avatar">
                    <div class="w-12 rounded-full">
                        <img src="https://picsum.photos/100" alt="User Avatar" />
                    </div>
                </div>
                <div>
                    <p class="font-semibold">Fillio Team</p>
                    <p class="text-sm text-gray-500">hello@fillio.com</p>
                </div>
                <label class="justify-self-end">
                    <Icon name="mdi:chevron-up"/>
                </label>
            </div>
            <h3 class="uppercase text-xs font-semibold text-gray-500 mb-2">Menu</h3>
            <menu class="menu w-full flex flex-col gap-1">
                {[
                    {"name": "Home", "icon": "home"},
                    {"name": "Workspaces", "icon": "briefcase"},
                    {"name": "Tasks", "icon": "wrench-screwdriver"},
                    {"name": "Results", "icon": "archive-box"},
                    {"name": "Presets", "icon": "queue-list"},
                    {"name": "Settings", "icon": "cog-8-tooth"}
                ].map(item => (
                    <li>
                        <a data-tab={item.name}
                            class="flex items-center gap-2"
                            x-bind:class="isCurrentTab($el, currentMainTab) && 'menu-active'"
                            x-on:click="currentMainTab = $el.dataset.tab">
                            <span>{item.name}</span>
                        </a>
                    </li>
                ))}
            </menu>
        </aside>
        
        <main class="flex flex-col w-full">
            <header class="flex justify-end items-center gap-6 p-6">
                <input type="text" 
                    placeholder="Search here..." 
                    class="input input-bordered max-w-x" />
                <div class="flex items-center gap-2">
                    <button class="btn btn-circle btn-ghost">
                        <Icon name="mdi:bell"/>
                    </button>
                    <Utils.Popover horizontal="dropdown-end">
                        <slot name="trigger">
                            <label class="avatar online">
                                <div class="w-10 rounded-full">
                                    <img src="https://picsum.photos/200" alt="User Avatar" />
                                </div>
                            </label>
                        </slot>
                        <menu class="menu menu-compact gap-1 w-30 border-1 rounded-box bg-base-100">
                            <li><a>Set Theme</a></li>
                            <li><form method="POST" action={urls.logout}>
                                <input type="submit" value="Logout">
                            </form></li>
                        </menu>
                    </Utils.Popover>
                </div>
            </header>
            <div class="bg-base-300 rounded-tl-3xl p-6 grow flex">
                {["Home", "Workspaces", "Tasks", "Results", "Notifications", "Settings"].map(tab => 
                    <section data-tab={tab} 
                        x-show="isCurrentTab($el, currentMainTab)"
                        class="flex flex-col grow">
                        <h1 class="text-2xl font-bold mb-6">{tab}</h1>
                    </section>
                )}
            </div>
        </main>
        <Utils.Dialog id="accountDeletionConfirmModal" type="button">
            <slot name="trigger">
                <Icon name="heroicons:x-mark-16-solid"/>
            </slot>
            <div>TO IMPLEMENT</div>
        </Utils.Dialog>
    </div>
</Layouts.Base>