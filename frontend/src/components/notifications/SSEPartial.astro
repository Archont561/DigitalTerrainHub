---
import { Utils } from "../index";

interface Props {
    notification: DjangoAPI.SSENotification;
    [key: string]: any,
}

const {
    notification = {} as DjangoAPI.SSENotification,
    ...props
} = Astro.props as Props;

if (!Object.keys(notification).length) {
    Object.assign(notification, (await import("../../assets/dummy/notification.json")).default);
}

const markNotificationReadURL = `/api/notifications/${notification.id}/read`;
---

<Utils.Alert 
    x-init="$nextTick(() => { setTimeout(() => { $el.remove() }, 3000) })"
    hx-patch={markNotificationReadURL}
    hx-swap="none"
    hx-trigger="load"
    type={notification.status}
    message={notification.message}
></Utils.Alert>